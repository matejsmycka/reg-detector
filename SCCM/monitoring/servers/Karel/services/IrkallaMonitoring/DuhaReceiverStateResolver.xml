<?xml version="1.0" encoding="utf-8" ?>
<stateResolver>
    <defaultOutput priority="99" state="OK" description="Connection to Duha controler is OK"/>

    <extractor name="default">
        <getAttribute path="workerDiagnostics.state" key="State" type="String" />
        <getInnerValue path="workerDiagnostics.lastMessageTimestamp" key="LastEventTime" type="DateTime" />
        <getAttribute path="workerDiagnostics.checkTimestamp" key="LastCheckTime" type="DateTime" />
    </extractor>    

    <interval axisName="LastCheckTime" to="1800" intervalName="LastCheckOK" />
    <interval axisName="LastCheckTime" from="1800" intervalName="LastCheckError" />
    <interval axisName="LastEventTime" to="345600" intervalName="LastEventOK" />
    <interval axisName="LastEventTime" from="345600" intervalName="LastEventWarning" />

    <multiSwitch name="StateSwitch" choice="State">
        <switchNode case="Error">
            <result key="State" value="Error" />
            <result key="Priority" value="10" />
            <result key="Description" value="Connection to Duha controler is malfunction" />
        </switchNode>
    </multiSwitch>

    <multiSwitch name="LastCheckTime" choice="LastCheckTime">
        <switchNode case="LastCheckError">
            <result key="State" value="Error" />
            <result key="Priority" value="15" />
            <result key="Description" value="Connection to Duha controller is malfunction" />
        </switchNode>
    </multiSwitch>

    <multiSwitch name="LastEventTime" choice="LastEventTime">
        <switchNode case="LastEventWarning">
            <result key="State" value="Warning" />
            <result key="Priority" value="20" />
            <result key="Description" value="No Duha event has arrived in expected time" />
        </switchNode>
    </multiSwitch>
</stateResolver>
